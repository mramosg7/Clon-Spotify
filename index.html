<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>hola</h1>
    <script>
        
        const tokenUrl = "https://accounts.spotify.com/api/token";
        const clientId = "acbe6c8d332d4ba3a9d02582135f57dc";
        const clientSecret = "912a467ada594154afdbddfb1aa70799";
    const urlParams = new URLSearchParams(window.location.search);
    let code = urlParams.get('code');
    const redirectUri = 'http://localhost:5500/prueba/index.html';
    const getToken = async code => {
            
        // stored in the previous step
        let codeVerifier = localStorage.getItem('code_verifier');
            console.log(code)
            console.log(codeVerifier)
            console.log(redirectUri)
            console.log(codeVerifier)
            console.log(clientId)
        const payload = {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: new URLSearchParams({
            "client_id": clientId,
            "grant_type": 'authorization_code',
            "code" : code,
            "redirect_uri": redirectUri,
            "code_verifier": codeVerifier,
        }),
        }

        const body = await fetch(tokenUrl, payload);
        const response =await body.json();

        localStorage.setItem('access_token', response.access_token);
    }

    getToken(code)
    </script>
</body>
</html>